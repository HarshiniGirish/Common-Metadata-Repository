#
# API Endpoints
#
ousBatchGenerate:
  handler: cmr.ous.app.handler.collection.batch_generate
  timeout: ${env:LAMBDA_TIMEOUT}
  events:
    - alb:
        listenerArn: ${cf:${opt:stage}.servicesLbListenerArn}
        priority: 70
        conditions:
          path: service-bridge/ous/collection

ousGenerateUrls:
  handler: cmr.ous.app.handler.collection.generate_urls
  timeout: ${env:LAMBDA_TIMEOUT}
  events:
    - alb:
        listenerArn: ${cf:${opt:stage}.servicesLbListenerArn}
        priority: 71
        conditions:
          path: service-bridge/ous/collection/{concept-id}
    - alb:
        listenerArn: ${cf:${opt:stage}.servicesLbListenerArn}
        priority: 72
        conditions:
          path: service-bridge/ous/collection/{concept-id}

ousStreamCollectionUrls:
  handler: cmr.ous.app.handler.collection.stream_urls
  timeout: ${env:LAMBDA_TIMEOUT}
  events:
    - abl:
        listenerArn: ${cf:${opt:stage}.servicesLbListenerArn}
        priority: 73
        conditions:
          path: /service-bridge/ous/streaming-collection/{concept-id}

health:
  handler: cmr.opendap.app.handler.core.health
  timeout: ${env:LAMBDA_TIMEOUT}
  events:
    - alb:
        listenerArn: ${cf:${opt:stage}.servicesLbListenerArn}
        priority: 74
        conditions:
          path: /service-bridge/health

healthOptions:
  handler: cmr.http.kit.app.handler.ok
  timeout: ${env:LAMBDA_TIMEOUT}
  events:
    - alb:
        listenerArn: ${cf:${opt:stage}.servicesLbListenerArn}
        priority: 75
        conditions:
          path: /service-bridge/health

#
# Documentation Endpoints
#
serivceBridgeDocs:
  handler: cmr.http.kit.app.handler.dynamic_page
  timeout: ${env:LAMBDA_TIMEOUT}
  events:
    - alb:
        listenerArn: ${cf:${opt:stage}.servicesLbListenerArn}
        priority: 76
        conditions:
          path: /service-bridge/docs
    - alb:
        listenerArn: ${cf:${opt:stage}.servicesLbListenerArn}
        priority: 77
        conditions:
          path: /service-bridge

serviceBridgeRobots:
  handler: cmr.http.kit.app.handler.permanent_redirect
  timeout: ${env:LAMBDA_TIMEOUT}
  events:
    - alb:
        listenerArn: ${cf:${opt:stage}.servicesLbListenerArn}
        priority: 78
        conditions:
          path: /service-bridge/robots.txt